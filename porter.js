// Generated by CoffeeScript 1.6.2
(function() {
  var PORT, SECRET, authed, portfinder, server, upnode, _ref;

  upnode = require('upnode');

  portfinder = require('portfinder');

  PORT = 7003;

  SECRET = (_ref = process.env.PORTER_PASS) != null ? _ref : 'o87asdoa87sa';

  authed = {
    port: function(cb) {
      return portfinder.getPort(cb);
    }
  };

  server = upnode(function(client, conn) {
    return this.auth = function(secret, cb) {
      if (secret === SECRET) {
        return cb(null, authed);
      }
      return cb('DENIED');
    };
  });

  server.listen(PORT);

  console.log("Server listening on " + PORT);

  module.exports = {
    authed: authed
  };

}).call(this);
